$.fn.datepicker=function(a){function g(a,b,c){var d=this;d.daysShort=["S","M","T","W","T","F","S"],d.field=a,d.options=c,d.today=ko.observable(moment()),d.datePickerValue=ko.observable(d.today()),d.viewingMonth=ko.observable(),d.viewingYear=ko.observable(),d.monthStruct=ko.observableArray(),d.viewingMonthName=ko.computed(function(){var a=["January","February","March","April","May","June","July","August","September","October","November","December"];return a[d.viewingMonth()-1]}),d.closePicker=function(){b.addClass("hide")},d.processDate=function(a){if(a){var b=moment(d.viewingYear()+"-"+d.viewingMonth()+"-"+a);d.datePickerValue(b);var f=(d.viewingYear(),d.viewingMonth(),d.datePickerValue().format(d.options.format));$(d.field).val(f)}},d.chooseDate=function(a){d.processDate(a),d.closePicker()},d.setupViewingDates=function(){d.viewingYear(d.datePickerValue().year()),d.viewingMonth(d.datePickerValue().month()+1)},d.buildMonthStruct=function(){d.monthStruct.removeAll();for(var a=d.viewingMonth(),b=d.viewingYear(),c=moment(b+"-"+a+"-01").startOf("month"),f=(c.format("dddd"),c.day()),g=c.endOf("month").date(),h=1,i=0;i<50;i++)i<f?d.monthStruct.push(""):(h<=g&&d.monthStruct.push(h),h++)},d.fetchDateFromField=function(){var b=$(a).val();b?d.datePickerValue(moment(b,d.options.format)):d.datePickerValue(moment()),d.setupViewingDates(),d.buildMonthStruct()},$(a).keyup(function(){d.fetchDateFromField()}),$(a).focus(function(){d.fetchDateFromField(),d.processDate(d.datePickerValue().date())}),d.nextMonth=function(){d.viewingMonth()<12?d.viewingMonth(d.viewingMonth()+1):(d.viewingMonth(1),d.viewingYear(d.viewingYear()+1)),d.buildMonthStruct()},d.prevMonth=function(){d.viewingMonth()>1?d.viewingMonth(d.viewingMonth()-1):(d.viewingMonth(12),d.viewingYear(d.viewingYear()-1)),d.buildMonthStruct()},d.isToday=function(a){var b=a==d.today().date(),c=d.viewingMonth()==d.today().month()+1,e=d.viewingYear()==d.today().year();return b&&c&&e},d.isSelected=function(a){var b=d.viewingMonth()==d.datePickerValue().month()+1,c=d.viewingYear()==d.datePickerValue().year();return a==d.date()&&b&&c},d.day=ko.computed(function(){return d.datePickerValue().format("dddd")}),d.date=ko.computed(function(){return d.datePickerValue().date()}),d.month=ko.computed(function(){return d.datePickerValue().format("MMMM")}),d.shortMonth=ko.computed(function(){return d.datePickerValue().format("MMM")}),d.year=ko.computed(function(){return d.datePickerValue().year()}),d.init=function(){d.fetchDateFromField(),d.buildMonthStruct()},d.init()}var b=['<div class="material-datepicker hide" tabindex="0">','<section class="top-day">','<span data-bind="text: day"></span>',"</section>",'<section class="middle-date">','<div class="month" data-bind="text: shortMonth"></div>','<div class="date" data-bind="text: date"></div>','<div class="year" data-bind="text: year"></div>',"</section>",'<section class="calendar no-select">','<a data-bind="click: prevMonth" class="control prev"> &#xf053 </a>','<a data-bind="click: nextMonth" class="control next"> &#xf054 </a>','<div class="title" data-bind="text: viewingMonthName() + \' \' + viewingYear()"></div>','<div class="headings" data-bind="foreach: daysShort">','<span data-bind="text: $data" class="day heading"></span>',"</div>",'<div class="days" data-bind="foreach : monthStruct()">','<a data-bind="css:{ selected: $parent.isSelected($data), today: $parent.isToday($data) },text: $data, click: function(data,event){ $parent.chooseDate(data) }" class="day" data-bind="text: $data"></a>',"</div>","</section>","</div>"].join("\n"),c=this,d=$(b);$(c).after(d),$(c).focus(function(){d.removeClass("hide")}),$(c).focusout(function(){setTimeout(function(){d.is(":focus")||d.addClass("hide")},10)}),d.focusout(function(){setTimeout(function(){$(c).is(":focus")||d.addClass("hide")},10)});var f=($(c).height(),{format:"DD/MM/YYYY",colour:"#009688"}),a=$.extend(f,a),h=new g(c,d,a);return window.viewModel=h,ko.applyBindings(h,d[0]),this};